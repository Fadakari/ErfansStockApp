
{% extends "base.html" %}

{% block content %}


<!-- <div id="subcat1" class="subcategories row mt-2 position-fixed w-75" style="scale: 0; opacity: 0; border-radius: 1rem; transition: scale 0.2s ease-in-out; transition: opacity 0.5s ease-in-out; top: 25%;">
    <i class="bi bi-x-lg col-lg-1 col-md-2 col-sm-3 btn p-3" onclick="close1()"></i>
    <div class="categor col-md-12 header-tabs rounded-5">
        <a href="{{ url_for('main.index', category=23) }}" class="btn btn-block d-flex align-items-center p-2">
            <i class="bi bi-wrench mr-2 ms-2"></i>
            دریل
        </a>
    </div>
    <div class="categor col-md-12 header-tabs rounded-5">
        <a href="{{ url_for('main.index', category=24) }}" class="btn btn-block d-flex align-items-center p-2">
            <i class="bi bi-wrench mr-2 ms-2"></i>
            فرز
        </a>
    </div>
    <div class="categor col-md-12 header-tabs rounded-5">
        <a href="{{ url_for('main.index', category=25) }}" class="btn btn-block d-flex align-items-center p-2">
            <i class="bi bi-wrench mr-2 ms-2"></i>
            کمپرسور
        </a>
    </div>
</div>

<div id="subcat2" class="subcategories mt-2 position-fixed rounded-3 w-75" style="scale: 0; opacity: 0; border-radius: 1rem; transition: scale 0.1s ease-in-out; transition: opacity 0.5s ease-in-out; top: 25%;">
    <i class="bi bi-x-lg col-lg-1 col-md-2 col-sm-3 btn p-3" onclick="close2()"></i>
    <div class="categor col-md-12 header-tabs rounded-5">
        <a href="{{ url_for('main.index', category=27) }}" class="btn btn-block d-flex align-items-center p-2">
            <i class="bi bi-wrench mr-2 ms-2"></i>
            اره برقی
        </a>
    </div>
    <div class="categor col-md-12 header-tabs rounded-5">
        <a href="{{ url_for('main.index', category=28) }}" class="btn btn-block d-flex align-items-center p-2">
            <i class="bi bi-wrench mr-2 ms-2"></i>
            چمن زن
        </a>
    </div>
</div> -->



<div class="categorys-container mt-4 w-75">
    <h2 class="mb-3 txt-black">دسته‌بندی‌ها</h2>
    <div class="mb-3">
        <a href="{{ url_for('main.index') }}" class="btn header-tabs shadower txt-black px-4 py-2">
            نمایش همه دسته‌بندی‌ها
        </a>
    </div>
    <div class="row">
        <!-- دسته‌بندی 1 (ابزار کرگیری) -->
        <div class="col-lg-3 col-md-6 col-sm-6 mb-2 d-flex justify-content-between flex-nowrap">
            <a href="{{ url_for('main.index', category=1) }}" class="btn header-tabs shadower btn-block d-flex align-items-center p-2 py-3 w-75 txt-black">
                <i class="bi bi-wrench mr-2 ms-2"></i>
                ابزار کرگیری
            </a>
            {% if categories[0].subcategories %}
            <!-- دکمه برای باز کردن/بستن زیردسته‌ها -->
            <div class="dropdown d-inline-block col-md-2 w-25">
                <button class="btn btn-sm header-tabs shadower bi bi-chevron-left h-100 w-100 txt-black" id="rotate" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                </button>
                <ul class="dropdown-menu dropdown-menu-end text-end p-0 rounded-4 w-auto" style="background-color: #000000!important; border: none; z-index: 9999!important;">
                    <li><a class="dropdown-item d-flex align-items-center header-tabs shadower-light txt-lighting rounded-3 rounded-bottom-0" href="{{ url_for('main.index', category=2) }}">
                        <i class="bi bi-wrench ms-2"></i> دریل</a></li>
                    <li><a class="dropdown-item d-flex align-items-center header-tabs shadower-light txt-lighting" href="{{ url_for('main.index', category=3) }}">
                        <i class="bi bi-wrench ms-2"></i> فرز</a></li>
                    <li><a class="dropdown-item d-flex align-items-center header-tabs shadower-light txt-lighting rounded-3 rounded-top-0" href="{{ url_for('main.index', category=4) }}">
                        <i class="bi bi-wrench ms-2"></i> کمپرسور</a></li>
                </ul>
            </div>
            
            {% endif %}
            
        </div>

        <!-- دسته‌بندی 2 (ابزار اندازه گیری) -->
        <div class="col-lg-3 col-md-6 col-sm-6 mb-2 d-flex justify-content-between flex-nowrap">
            <a href="{{ url_for('main.index', category=5) }}" class="btn header-tabs shadower btn-block d-flex align-items-center p-2 py-3 w-75 txt-black">
                <i class="bi bi-rulers mr-2 ms-2"></i>
                ابزار اندازه گیری
            </a>
            {% if categories[1].subcategories %}
            <!-- دکمه برای باز کردن/بستن زیردسته‌ها -->
            <div class="dropdown d-inline-block col-md-2 w-25">
                <button class="btn btn-sm header-tabs shadower bi bi-chevron-left h-100 w-100 txt-black" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                </button>
                <ul class="dropdown-menu dropdown-menu-end text-end p-0 rounded-4 w-auto" style="background-color: #000000!important; border: none; z-index: 9999;">
                    <li><a class="dropdown-item d-flex align-items-center header-tabs shadower-light txt-lighting rounded-3 rounded-bottom-0" href="{{ url_for('main.index', category=6) }}">
                        <i class="bi bi-wrench ms-2"></i> اره برقی</a></li>
                    <li><a class="dropdown-item d-flex align-items-center header-tabs shadower-light txt-lighting rounded-3 rounded-top-0" href="{{ url_for('main.index', category=7) }}">
                        <i class="bi bi-wrench ms-2"></i> چمن زن</a></li>
                </ul>
            </div>
            
            {% endif %}
            
        </div>

        <!-- دسته‌بندی 3 -->
        <div class="col-lg-3 col-md-6 col-sm-6 mb-2">
            <a href="{{ url_for('main.index', category=8) }}" class="btn header-tabs shadower btn-block d-flex align-items-center p-2 py-3 txt-black">
                <i class="bi bi-tools mr-2 ms-2"></i>
                مته و قلم
            </a>
        </div>

        <!-- دسته‌بندی 4 -->
        <div class="col-lg-3 col-md-6 col-sm-6 mb-2">
            <a href="{{ url_for('main.index', category=11) }}" class="btn header-tabs shadower btn-block d-flex align-items-center p-2 py-3 txt-black">
                <i class="bi bi-hammer mr-2 ms-2"></i>
                سیستم میخکوب ها
            </a>
        </div>

        <!-- دسته‌بندی 5 -->
        <div class="col-lg-3 col-md-6 col-sm-6 mb-2">
            <a href="{{ url_for('main.index', category=12) }}" class="btn header-tabs shadower btn-block d-flex align-items-center p-2 py-3 txt-black">
                <i class="bi bi-lightning-charge mr-2 ms-2"></i>
                ابزار برقی
            </a>
        </div>

        <!-- دسته‌بندی 6 -->
        <div class="col-lg-3 col-md-6 col-sm-6 mb-2">
            <a href="{{ url_for('main.index', category=13) }}" class="btn header-tabs shadower btn-block d-flex align-items-center p-2 py-3 txt-black">
                <i class="bi bi-battery-full mr-2 ms-2"></i>
                ابزار شارژی
            </a>
        </div>
    </div>
</div>

<form class="address-searcher d-flex w-100 mb-5 mt-3" action="{{ url_for('main.index') }}" method="GET">
    <div class="d-flex w-100 m-auto">
        <input class="me-2 inputs searcher txt-black" type="search" placeholder="جستجوی آدرس..." name="address_search" value="{{ request.args.get('address_search', '') }}">
        <button class="btn header-tabs w-25 txt-black" type="submit">جستجو</button>
    </div>
</form>



<h2 class="mb-4 txt-black">محصولات</h2>

<div class="row row-cols-1 row-cols-md-2 row-cols-lg-2 row-cols-xl-4 g-4 prod mb-5">
    {% for product in products %}
    <div class="col">
        <a href="{{ url_for('main.product_detail', product_id=product.id) }}" class="text-decoration-none">
            <div class="card animationshow productes h-100 header-tabs text-light">
                {% if product.image_path %}
                <img src="{{ url_for('static', filename='uploads/' + product.image_path) }}" class="card-img-top" alt="{{ product.name }}">
                {% endif %}
                <div class="card-body">
                    <h5 class="card-title txt-black">{{ product.name }}</h5>
                    {% if product.promoted_until and product.promoted_until > datetime.utcnow() %}
                        <p style="color: green; font-weight: bold;">✅ نردبان شده</p>
                    {% endif %}
                    <p class="card-text description px-2">{{ product.description }}</p>
                    {% if product.address %}
                        <p class="txt-black">{{ product.address }}</p>
                    {% endif %}
                    {% if product.price == product.price|int %}
                      <p class="card-text txt-black"><strong>{{ "{:,}".format(product.price | int) }} تومان</strong></p>
                    {% else %}
                      <p class="card-text txt-black"><strong>{{ "{:,.2f}".format(product.price) }} تومان</strong></p>
                    {% endif %}
                </div>
            </div>
        </a>
    </div>
    {% endfor %}
</div>

<script>
    function copyText(element) {
            const text = element.innerText || element.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                let toast = document.createElement("span");
                toast.classList.add("toast-message");
                toast.innerText = "متن با موفقیت کپی شد!";
                
                document.body.appendChild(toast);

                // نمایش پیام
                setTimeout(() => {
                    toast.classList.add("show");
                }, 10);

                // حذف پیام بعد از 2 ثانیه
                setTimeout(() => {
                    toast.classList.remove("show");
                    setTimeout(() => {
                        toast.remove();
                    }, 300);
                }, 2000);
            }).catch(err => {
                console.error("خطا در کپی کردن متن:", err);
            });
        }
</script>
<script>
    document.addEventListener("DOMContentLoaded", () => {
      const animatables = document.querySelectorAll(".animationshow");
  
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add("show");
          } else {
            entry.target.classList.remove("show");
          }
        });
      }, {
        threshold: 0.1
      });
  
      animatables.forEach(el => {
        observer.observe(el);
      });
    });
  </script>



{% endblock %}

