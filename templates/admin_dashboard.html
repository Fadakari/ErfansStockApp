{% extends "base.html" %}

{% block content %}
<button class="btn header-tabs py-2 px-3 float-start">
    <a href="{{ url_for('main.index') }}">
        <i class="bi bi-arrow-left fs-3 txt-black"></i>
    </a>
</button>
<h2 class="txt-black">Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª</h2>
<hr class="w-100">
<h3 class="txt-black">ØªØ¹Ø¯Ø§Ø¯ Ù…Ø­ØµÙˆÙ„Ø§Øª Ù¾Ù„ØªÙØ±Ù…: {{ count }}</h3>
<h3 class="txt-black">ØªØ¹Ø¯Ø§Ø¯ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¢Ù†Ù„Ø§ÛŒÙ†: <span id="userCount">...</span></h3>
<h3 class="txt-black">ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†: {{ total_users }}</h3>
<hr class="w-100 txt-black">
 <script>
        function fetchOnlineUsers() {
            fetch('/online-users')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('userCount').innerText = data.count;
                });
        }

        fetchOnlineUsers();
        setInterval(fetchOnlineUsers, 1000);
    </script>



<h3 class="txt-black mt-5 mb-5">Ù…Ø­ØµÙˆÙ„Ø§Øª Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ£ÛŒÛŒØ¯</h3>
<div class="row row-cols-1 row-cols-md-2 row-cols-lg-2 row-cols-xl-3 g-4 prod mb-5">
    {% for product in pending_products %}
    <div class="col">
        <a href="{{ url_for('main.product_detail', product_id=product.id) }}">
        <div class="card productes h-100 header-tabs text-light">
            {% if product.image_path %}
            <img src="{{ url_for('static', filename='uploads/' + product.image_path) }}" class="card-img-top" alt="{{ product.name }}">
            {% endif %}
            <div class="card-body">
                <h5 class="card-title txt-black">{{ product.name }}</h5>
                <p class="card-text description px-2">{{ product.description }}</p>
                {% if product.address %}
                    <p class="txt-black">{{ product.address }}</p>
                {% endif %}
                <p class="card-text txt-black"><strong>{{ "{:,}".format(product.price | int) }} ØªÙˆÙ…Ø§Ù†</strong></p>
                <p class="txt-black">Ú©Ø§Ø±Ø¨Ø±: {{ users_dict[product.user_id] }}</p>
                <p class="txt-black">Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯Ù‡: {{ product.created_at | jalali }}</p>

                <form method="POST" action="{{ url_for('main.approve_product', product_id=product.id) }}">
                    <button type="submit" class="btn btn-success w-100 mt-2">âœ”ï¸ ØªØ£ÛŒÛŒØ¯ Ù…Ø­ØµÙˆÙ„</button>
                </form>
            </div>
        </div>
        </a>
    </div>
    {% endfor %}
</div>

<hr class="w-100 txt-black">


{% if highly_reported_products %}
<div class="my-4">
    <h3 class="txt-black">âš ï¸ Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§ÛŒ Ú¯Ø²Ø§Ø±Ø´ ØªØ®Ù„Ù</h3>
    {% for product, report_count in highly_reported_products %}
        {% if report_count >= 5 %}
            <div class="alert alert-danger d-flex justify-content-between align-items-center">
                <div>
                    <i class="bi bi-shield-fill-exclamation me-2"></i>
                    <strong>Ø®Ø·Ø±:</strong> Ù…Ø­ØµÙˆÙ„ <strong>{{ product.name }}</strong> ØªØ¹Ø¯Ø§Ø¯ <strong>{{ report_count }}</strong> Ú¯Ø²Ø§Ø±Ø´ ØªØ®Ù„Ù Ø¯Ø±ÛŒØ§ÙØª Ú©Ø±Ø¯Ù‡ Ø§Ø³Øª.
                </div>
                <a href="{{ url_for('main.product_detail', product_id=product.id) }}" target="_blank" class="btn btn-danger btn-sm">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù…Ø­ØµÙˆÙ„</a>
            </div>
        {% elif report_count >= 3 %}
            <div class="alert alert-warning d-flex justify-content-between align-items-center">
                <div>
                    <i class="bi bi-exclamation-triangle-fill me-2"></i>
                    <strong>Ù‡Ø´Ø¯Ø§Ø±:</strong> Ù…Ø­ØµÙˆÙ„ <strong>{{ product.name }}</strong> ØªØ¹Ø¯Ø§Ø¯ <strong>{{ report_count }}</strong> Ú¯Ø²Ø§Ø±Ø´ ØªØ®Ù„Ù Ø¯Ø±ÛŒØ§ÙØª Ú©Ø±Ø¯Ù‡ Ø§Ø³Øª.
                </div>
                <a href="{{ url_for('main.product_detail', product_id=product.id) }}" target="_blank" class="btn btn-warning btn-sm">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù…Ø­ØµÙˆÙ„</a>
            </div>
        {% endif %}
    {% endfor %}
</div>
<hr class="w-100 txt-black">
{% endif %}


<h3 class="txt-black">Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§ÛŒ ØªØ®Ù„Ù</h3>


<div class="table-responsive">
    <table class="table bg-black rounded-3 mb-5">
        <thead>
            <tr>
                <th class="text-end">Ú©Ø§Ø±Ø¨Ø± Ú¯Ø²Ø§Ø±Ø´â€ŒØ¯Ù‡Ù†Ø¯Ù‡</th>
                <th class="text-end">Ù…Ø­ØµÙˆÙ„</th>
                <th class="text-end">Ø´Ø±Ø­ Ú¯Ø²Ø§Ø±Ø´</th>
                <th class="text-end">ØªØ§Ø±ÛŒØ®</th>
            </tr>
        </thead>
        <tbody class="bg-very-black">
            {% for report in reports %}
            <tr>
                <td>{{ report.reporter.username }}</td>
                <td><a href="{{ url_for('main.product_detail', product_id=report.product.id) }}" target="_blank">{{ report.product.name }}</a></td>
                <td>{{ report.text }}</td>
                <td>{{ report.created_at | jalali }}</td>
                <td>
                    <form action="{{ url_for('main.delete_report', report_id=report.id) }}" method="post" onsubmit="return confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ø§ÛŒÙ† Ú¯Ø²Ø§Ø±Ø´ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ');">
                      <button type="submit" class="btn btn-danger btn-sm">ğŸ—‘ Ø­Ø°Ù</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<hr class="w-100 txt-black">

<h3 class="txt-black">Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§ÛŒ ØªØ®Ù„Ù Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</h3>
<div class="table-responsive">
    <table class="table bg-black rounded-3 mb-5">
        <thead>
            <tr>
                <th class="text-end">Ú©Ø§Ø±Ø¨Ø± Ú¯Ø²Ø§Ø±Ø´â€ŒØ¯Ù‡Ù†Ø¯Ù‡</th>
                <th class="text-end">Ú©Ø§Ø±Ø¨Ø± Ù…ØªØ®Ù„Ù</th>
                <th class="text-end">Ø´Ø±Ø­ Ú¯Ø²Ø§Ø±Ø´</th>
                <th class="text-end">ØªØ§Ø±ÛŒØ®</th>
                <th class="text-end">Ù…Ú©Ø§Ù„Ù…Ù‡</th>
            </tr>
        </thead>
        <tbody class="bg-very-black">
            {% for report in user_reports %}
            <tr>
                <td><a href="{{ url_for('main.user_dashboard', user_id=report.reporter.id) }}" target="_blank">{{ report.reporter.username }}</a></td>
                <td><a href="{{ url_for('main.user_dashboard', user_id=report.reported.id) }}" target="_blank">{{ report.reported.username }}</a></td>
                <td>{{ report.reason }}</td>
                <td>{{ report.created_at | jalali }}</td>
                <td>
                    {% if report.conversation %}
                        <a href="{{ url_for('main.conversation', conversation_id=report.conversation.id) }}" target="_blank" class="btn btn-info btn-sm">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú†Øª</a>
                    {% else %}
                        <span>-</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<hr class="w-100 txt-black">

<h3 class="txt-black">ØªÛŒÚ©Øªâ€ŒÙ‡Ø§ÛŒ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ</h3>
<div class="table-responsive">
    <table class="table bg-black rounded-3 mb-5">
        <thead>
            <tr>
                <th class="text-end">#</th>
                <th class="text-end">Ù…ÙˆØ¶ÙˆØ¹</th>
                <th class="text-end">Ú©Ø§Ø±Ø¨Ø±</th>
                <th class="text-end">ÙˆØ¶Ø¹ÛŒØª</th>
                <th class="text-end">Ø¢Ø®Ø±ÛŒÙ† Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ</th>
                <th class="text-end">Ø¹Ù…Ù„ÛŒØ§Øª</th>
            </tr>
        </thead>
        <tbody class="bg-very-black">
            {% for ticket in all_tickets %}
            <tr>
                <td>{{ ticket.id }}</td>
                <td>{{ ticket.subject }}</td>
                <td>{{ ticket.user.username }}</td>
                <td>
                    {% if ticket.status.name == 'USER_REPLIED' %}
                        <span class="badge bg-warning text-dark">{{ ticket.status.value }}</span>
                    {% elif ticket.status.name == 'OPEN' %}
                        <span class="badge bg-primary">{{ ticket.status.value }}</span>
                    {% elif ticket.status.name == 'ADMIN_REPLIED' %}
                        <span class="badge bg-success">{{ ticket.status.value }}</span>
                    {% else %}
                        <span class="badge bg-secondary">{{ ticket.status.value }}</span>
                    {% endif %}
                </td>
                <td>{{ ticket.updated_at | jalali }}</td>
                <td>
                    <a href="{{ url_for('main.view_ticket', ticket_id=ticket.id) }}" class="btn btn-info btn-sm">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ùˆ Ù¾Ø§Ø³Ø®</a>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="6" class="text-center p-4">Ù‡ÛŒÚ† ØªÛŒÚ©ØªÛŒ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>


<hr class="w-100 txt-black">

<h3 class="txt-black">Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§ÛŒ ØªØ®Ù„Ù Ø¢Ú¯Ù‡ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªØ®Ø¯Ø§Ù…</h3>
<div class="table-responsive">
    <table class="table bg-black rounded-3 mb-5">
        <thead>
            <tr>
                <th class="text-end">Ú©Ø§Ø±Ø¨Ø± Ú¯Ø²Ø§Ø±Ø´â€ŒØ¯Ù‡Ù†Ø¯Ù‡</th>
                <th class="text-end">Ø¢Ú¯Ù‡ÛŒ Ø§Ø³ØªØ®Ø¯Ø§Ù…</th>
                <th class="text-end">Ø´Ø±Ø­ Ú¯Ø²Ø§Ø±Ø´</th>
                <th class="text-end">ØªØ§Ø±ÛŒØ®</th>
                <th class="text-end">Ø¹Ù…Ù„ÛŒØ§Øª</th>
            </tr>
        </thead>
        <tbody class="bg-very-black">
            {% for report in job_listing_reports %}
            <tr>
                <td>{{ report.reporter.username }}</td>
                <td><a href="{{ url_for('main.job_listing_detail', job_id=report.job_listing.id) }}" target="_blank">{{ report.job_listing.title }}</a></td>
                <td>{{ report.reason }}</td>
                <td>{{ report.created_at | jalali }}</td>
                <td>
                    <form action="{{ url_for('main.delete_job_listing_report', report_id=report.id) }}" method="post" onsubmit="return confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ø§ÛŒÙ† Ú¯Ø²Ø§Ø±Ø´ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ');">
                      <button type="submit" class="btn btn-danger btn-sm">ğŸ—‘ Ø­Ø°Ù</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<hr class="w-100 txt-black">

<h3 class="txt-black">Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§ÛŒ ØªØ®Ù„Ù Ù¾Ø±ÙˆÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±ÛŒØ§Ø¨ÛŒ</h3>
<div class="table-responsive">
    <table class="table bg-black rounded-3 mb-5">
        <thead>
            <tr>
                <th class="text-end">Ú©Ø§Ø±Ø¨Ø± Ú¯Ø²Ø§Ø±Ø´â€ŒØ¯Ù‡Ù†Ø¯Ù‡</th>
                <th class="text-end">Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ú©Ø§Ø±ÛŒØ§Ø¨ÛŒ</th>
                <th class="text-end">Ø´Ø±Ø­ Ú¯Ø²Ø§Ø±Ø´</th>
                <th class="text-end">ØªØ§Ø±ÛŒØ®</th>
                <th class="text-end">Ø¹Ù…Ù„ÛŒØ§Øª</th>
            </tr>
        </thead>
        <tbody class="bg-very-black">
            {% for report in job_profile_reports %}
            <tr>
                <td>{{ report.reporter.username }}</td>
                <td><a href="{{ url_for('main.job_profile_detail', profile_id=report.job_profile.id) }}" target="_blank">{{ report.job_profile.title }}</a></td>
                <td>{{ report.reason }}</td>
                <td>{{ report.created_at | jalali }}</td>
                <td>
                    <form action="{{ url_for('main.delete_job_profile_report', report_id=report.id) }}" method="post" onsubmit="return confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ø§ÛŒÙ† Ú¯Ø²Ø§Ø±Ø´ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ');">
                      <button type="submit" class="btn btn-danger btn-sm">ğŸ—‘ Ø­Ø°Ù</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<hr class="w-100 txt-black">


<div class="mb-3">
    <input type="text" id="blocked-product-search" class="inputs flex-grow-1" placeholder="Ø¬Ø³ØªØ¬Ùˆ Ø¯Ø± Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„ØŒ ØªÙˆØ¶ÛŒØ­Ø§Øª ÛŒØ§ Ù†Ø§Ù… Ù…Ø§Ù„Ú©...">
</div>

<div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4" id="blocked-products-container">
    {% include '_blocked_products_list.html' with context %}
</div>


<script>
document.addEventListener('DOMContentLoaded', function() {
    const searchInput = document.getElementById('blocked-product-search');
    const container = document.getElementById('blocked-products-container');
    let searchTimeout;

    searchInput.addEventListener('keyup', function() {
        clearTimeout(searchTimeout);
        
        const query = this.value;

        searchTimeout = setTimeout(() => {
            fetch(`/admin/search_blocked_products?q=${encodeURIComponent(query)}`)
                .then(response => response.text())
                .then(html => {
                    container.innerHTML = html;
                })
                .catch(error => {
                    console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¬Ø³ØªØ¬ÙˆÛŒ Ø§ÛŒØ¬Ú©Ø³:', error);
                    container.innerHTML = '<p class="text-danger text-center">Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†ØªØ§ÛŒØ¬.</p>';
                });
        }, 500);
    });
});
</script>

<hr class="w-100 txt-black">

<h3 class="txt-black">Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</h3>
<form method="GET" action="{{ url_for('main.admin_dashboard') }}" class="d-flex flex-wrap gap-2 mb-3">
    <input type="text" name="query" class="inputs flex-grow-1" placeholder="Ø¬Ø³Øªâ€ŒÙˆØ¬ÙˆÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†...">
    <select name="role_filter" class="form-select txt-black">
        <option class="txt-black" value="">Ù‡Ù…Ù‡ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</option>
        <option class="txt-black" value="admin">ÙÙ‚Ø· Ø§Ø¯Ù…ÛŒÙ†â€ŒÙ‡Ø§</option>
        <option class="txt-black" value="user">ÙÙ‚Ø· Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¹Ø§Ø¯ÛŒ</option>
    </select>
    <button type="submit" class="btn btn-primary">Ø¬Ø³Øªâ€ŒÙˆØ¬Ùˆ</button>
</form>

<div class="table-responsive">
    <table class="table bg-black rounded-3 mb-5">
        <thead class="bg-black">
            <tr>
                <th class="text-end">Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ</th>
                <th class="text-end">Ø§ÛŒÙ…ÛŒÙ„</th>
                <th class="text-end">Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ†</th>
                <th class="text-end">Ú©Ø¯ Ù…Ù„ÛŒ</th>
                <th class="text-end">Ø¯Ø³ØªØ±Ø³ÛŒ Ø§Ø¯Ù…ÛŒÙ†</th>
                <th class="text-end">Ø¹Ù…Ù„ÛŒØ§Øª</th>
                <th class="text-end">Ù…Ø³Ø¯ÙˆØ¯/Ø±ÙØ¹ Ø§Ù†Ø³Ø¯Ø§Ø¯</th>
            </tr>
        </thead>
        <tbody class="bg-very-black">
            {% for user in users %}
            <tr>
                <td style="cursor: pointer;" onclick="copyText(this)">{{ user.username }}</td>
                <td style="cursor: pointer;" onclick="copyText(this)">{{ user.email }}</td>
                <td style="cursor: pointer;" onclick="copyText(this)">{{ user.phone }}</td>
                <td style="cursor: pointer;" onclick="copyText(this)">{{ user.national_id }}</td>
                <td style="cursor: pointer;" onclick="copyText(this)">{{ "Ø§Ø¯Ù…ÛŒÙ†" if user.is_admin else "Ú©Ø§Ø±Ø¨Ø± Ø¹Ø§Ø¯ÛŒ" }}</td>
                <td class="d-flex flex-wrap gap-2" style="cursor: pointer;">
                    <a href="{{ url_for('main.user_dashboard', user_id=user.id) }}" class="btn btn-info">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</a>
                
                    {% if not user.is_admin %}
                        <form action="{{ url_for('main.make_admin', user_id=user.id) }}" method="POST">
                            <button type="submit" class="btn btn-primary">Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø§Ø¯Ù…ÛŒÙ†</button>
                        </form>
                    {% else %}
                        <form action="{{ url_for('main.remove_admin', user_id=user.id) }}" method="POST">
                            <button type="submit" class="btn btn-warning" onclick="return confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø§ÛŒÙ† Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ Ø§Ø² Ø§Ø¯Ù…ÛŒÙ†ÛŒ Ø­Ø°Ù Ú©Ù†ÛŒØ¯ØŸ')">Ø­Ø°Ù Ø§Ø¯Ù…ÛŒÙ†</button>
                        </form>
                    {% endif %}
                    
                    <form action="{{ url_for('main.delete_user', user_id=user.id) }}" method="POST">
                        <button type="submit" class="btn btn-danger" onclick="return confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ')">Ø­Ø°Ù Ú©Ø§Ø±Ø¨Ø±</button>
                    </form>
                </td>
                <td>
                    {% if not user.is_admin %} {% if user.is_banned %}
                            <form action="{{ url_for('main.unban_user', user_id=user.id) }}" method="POST" class="d-inline">
                                <button type="submit" class="btn btn-sm btn-success">Ø±ÙØ¹ Ù…Ø³Ø¯ÙˆØ¯ÛŒØª</button>
                            </form>
                        {% else %}
                            <form action="{{ url_for('main.ban_user', user_id=user.id) }}" method="POST" class="d-inline">
                                <button type="submit" class="btn btn-sm btn-warning">Ù…Ø³Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù†</button>
                            </form>
                        {% endif %}
                    {% endif %}
                </td>
            </tr>
            {% endfor %}

        </tbody>
    </table>
</div>



<!-- <div class="text-center my-4">
    <button class="btn btn-danger" onclick="cleanupUnusedImages()">ğŸ§¹ Ø­Ø°Ù ØªØµØ§ÙˆÛŒØ± Ø¨Ù„Ø§Ø§Ø³ØªÙØ§Ø¯Ù‡</button>
</div> -->



<script>
function cleanupUnusedImages() {
    if (!confirm("Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ ØªØµØ§ÙˆÛŒØ± Ø¨Ù„Ø§Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø­Ø°Ù Ø´ÙˆÙ†Ø¯ØŸ")) return;

    fetch('/admin/cleanup-images', {
        method: 'POST',
        headers: {
            'X-Requested-With': 'XMLHttpRequest'
        }
    })
    .then(res => res.json())
    .then(data => {
        alert(data.message);
    })
    .catch(err => {
        alert("Ø®Ø·Ø§ÛŒÛŒ Ø¯Ø± Ø­Ø°Ù ØªØµØ§ÙˆÛŒØ± Ø±Ø® Ø¯Ø§Ø¯");
        console.error(err);
    });
}
</script>

<!-- <h3>Ø§ÙØ²ÙˆØ¯Ù† Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ø¬Ø¯ÛŒØ¯</h3>
<form action="{{ url_for('main.add_category') }}" method="POST" class="d-flex flex-wrap gap-2">
    <input type="text" name="category_name" class="inputs flex-grow-1" placeholder="Ù†Ø§Ù… Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ø¬Ø¯ÛŒØ¯" required>
    <button type="submit" class="btn btn-success">Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù†</button>
</form>

<h3>Ù…Ø¯ÛŒØ±ÛŒØª Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒâ€ŒÙ‡Ø§</h3>
<div class="table-responsive" style="margin-bottom: 6rem;">
    <table class="table">
        <thead>
            <tr>
                <th>Ù†Ø§Ù… Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</th>
                <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
            </tr>
        </thead>
        <tbody>
            {% for category in categories %}
            <tr>
                <td>{{ category.name }}</td>
                <td>
                    <form action="{{ url_for('main.delete_category', category_id=category.id) }}" method="POST">
                        <button type="submit" class="btn btn-danger" onclick="return confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ')">Ø­Ø°Ù Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div> -->

<script>
    function copyText(element) {
        const text = element.innerText || element.textContent;
        navigator.clipboard.writeText(text).then(() => {
            alert("Ù…ØªÙ† Ú©Ù¾ÛŒ Ø´Ø¯!");
        }).catch(err => {
            console.error("Ø®Ø·Ø§ Ø¯Ø± Ú©Ù¾ÛŒ Ú©Ø±Ø¯Ù† Ù…ØªÙ†:", err);
        });
    }
</script>
{% endblock %}